<!DOCTYPE html>
<!-- ez a f≈ë html, neve microsimple.html -->
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>K√©t Ablakos Hangfelismer√©s</title>
    <script src="extra1universal.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <style>
        body {
            margin: 0;
            padding: 10px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }
        
        .container {
            width: 100%;
            max-width: 1400px; /* N√∂velt√ºk a max-width-ot */
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            box-sizing: border-box;
        }
        
        .title {
            text-align: center;
            color: white;
            font-size: 24px;
            margin-bottom: 5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            width: 100%;
        }
        
        .windows-container {
            display: flex;
            width: 100%;
            gap: 15px;
            min-height: 300px;
            margin-bottom: 10px;
            flex-wrap: nowrap; /* Mindig egym√°s mellett maradnak */
        }
        
        .window {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 12px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            min-height: 250px;
            min-width: 300px; /* Minimum sz√©less√©g hogy ne legyen t√∫l keskeny */
        }
        
        .window-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            padding-bottom: 6px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            flex-shrink: 0;
        }
        
        /* Szerkeszthet≈ë textarea st√≠lus a bal oldali ablakhoz */
        .editable-textarea {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px;
            overflow-y: auto;
            font-size: 36px; /* Tripla bet≈±m√©ret, de kicsit kisebb tableten */
            line-height: 1.4;
            min-height: 200px;
            white-space: pre-wrap;
            word-wrap: break-word;
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            font-family: inherit;
            resize: vertical;
        }
        
        .editable-textarea:focus {
            outline: none;
            border-color: #4CAF50;
            box-shadow: 0 0 0 2px rgba(76, 175, 80, 0.3);
        }
        
        .window-content {
            flex: 1;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            padding: 12px;
            overflow-y: auto;
            font-size: 36px; /* Tripla bet≈±m√©ret, de kicsit kisebb tableten */
            line-height: 1.4;
            min-height: 200px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .status-display {
            background: rgba(255, 255, 255, 0.1);
            padding: 12px 20px;
            border-radius: 12px;
            font-size: 16px;
            text-align: center;
            width: 100%;
            border: 2px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
            margin: 8px 0;
            box-sizing: border-box;
        }
        
        .buttons-row {
            display: flex;
            width: 100%;
            gap: 10px;
            margin: 5px 0;
            flex-wrap: wrap; /* Gombok wrap-elhetnek keskeny k√©perny≈ën */
        }
        
        .buttons-row.top-row {
            margin-bottom: 5px;
        }
        
        .buttons-row.bottom-row {
            margin-top: 5px;
        }
        
        .control-button {
            flex: 1;
            padding: 15px 8px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            min-height: 80px;
            min-width: 120px; /* Minimum sz√©less√©g a gomboknak */
        }
        
        .control-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .control-button:active {
            transform: translateY(-1px);
        }
        
        .button-1 { background: linear-gradient(135deg, #4CAF50, #2E7D32); }
        .button-2 { background: linear-gradient(135deg, #FF9800, #E65100); }
        .button-3 { background: linear-gradient(135deg, #9C27B0, #7B1FA2); }
        .button-4 { background: linear-gradient(135deg, #2196F3, #0D47A1); }
        .button-5 { background: linear-gradient(135deg, #00BCD4, #006064); }
        .button-6 { background: linear-gradient(135deg, #FF5722, #BF360C); }
        .button-7 { background: linear-gradient(135deg, #FF4081, #F50057); }
        .button-8 { background: linear-gradient(135deg, #F44336, #B71C1C); }
        
        .button-label {
            font-size: 12px;
            opacity: 0.9;
            text-align: center;
            line-height: 1.2;
        }
        
        .key-indicator {
            background: rgba(255, 255, 255, 0.2);
            padding: 3px 6px;
            border-radius: 4px;
            font-size: 10px;
            margin-top: 2px;
        }
        
        .recording {
            background: rgba(220, 53, 69, 0.3) !important;
            border-color: #dc3545 !important;
            animation: pulse 1.5s infinite;
        }
        
        .paused {
            background: rgba(255, 193, 7, 0.3) !important;
            border-color: #ffc107 !important;
        }
        
        .success {
            background: rgba(40, 167, 69, 0.3) !important;
            border-color: #28a745 !important;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0.7); }
            70% { box-shadow: 0 0 0 15px rgba(220, 53, 69, 0); }
            100% { box-shadow: 0 0 0 0 rgba(220, 53, 69, 0); }
        }
        
        .instructions {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 12px;
            width: 100%;
            margin-top: 15px;
            box-sizing: border-box;
        }
        
        .instructions h3 {
            color: #4CAF50;
            margin-top: 0;
            margin-bottom: 12px;
            font-size: 16px;
        }
        
        .instructions ul {
            list-style: none;
            padding: 0;
            margin: 0;
            display: grid;
            grid-template-columns: 1fr; /* Mobilon egy oszlop */
            gap: 10px;
        }
        
        .instructions li {
            padding: 6px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 12px;
            line-height: 1.4;
        }
        
        .instructions li:last-child {
            border-bottom: none;
        }
        
        .key {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 4px;
            font-weight: bold;
            font-family: monospace;
            font-size: 11px;
        }
        
        .left-window {
            border-color: #4CAF50;
        }
        
        .right-window {
            border-color: #2196F3;
        }
        
        .empty-window {
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            font-size: 36px; /* Tripla bet≈±m√©ret */
        }
        
        .clipboard-notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(33, 150, 243, 0.9);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            z-index: 1000;
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 1.7s forwards;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-size: 14px;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* T√°blag√©p √©s mobil m√≥dos√≠t√°sok - MOST M√ÅR EGYM√ÅS MELLETT MARADNAK */
        @media (max-width: 1024px) {
            .container {
                padding: 10px;
                gap: 10px;
            }
            
            .windows-container {
                gap: 10px;
                min-height: 250px;
            }
            
            .window {
                min-height: 220px;
                min-width: 250px; /* Kisebb minimum sz√©less√©g tableten */
                padding: 10px;
            }
            
            .window-content, .empty-window, .editable-textarea {
                font-size: 28px; /* Kisebb bet≈±m√©ret tableten */
                padding: 10px;
            }
            
            .control-button {
                min-width: calc(25% - 8px); /* 4 gomb soronk√©nt tableten */
                padding: 12px 6px;
                min-height: 70px;
                font-size: 14px;
            }
            
            .button-label {
                font-size: 10px;
            }
            
            .instructions ul {
                grid-template-columns: 1fr;
            }
            
            .title {
                font-size: 20px;
            }
        }
        
        /* Nagyon keskeny k√©perny≈ëk (mobil) */
        @media (max-width: 600px) {
            body {
                padding: 5px;
            }
            
            .container {
                padding: 8px;
                border-radius: 10px;
            }
            
            .windows-container {
                flex-direction: row; /* M√âG MINDIG egym√°s mellett! */
                overflow-x: auto; /* G√∂rget√©s ha t√∫l keskeny */
                min-height: 200px;
            }
            
            .window {
                min-width: 280px; /* Mobilon is minimum sz√©less√©g */
                min-height: 200px;
            }
            
            .window-content, .empty-window, .editable-textarea {
                font-size: 24px; /* Kisebb bet≈±m√©ret mobilon */
            }
            
            .control-button {
                min-width: calc(50% - 5px); /* 2 gomb soronk√©nt mobilon */
                padding: 10px 5px;
                min-height: 65px;
                font-size: 14px;
            }
            
            .button-label {
                font-size: 9px;
            }
            
            .instructions li {
                font-size: 11px;
            }
            
            .title {
                font-size: 18px;
            }
        }
        
        /* Extra keskeny k√©perny≈ëk */
        @media (max-width: 400px) {
            .window {
                min-width: 240px;
            }
            
            .window-content, .empty-window, .editable-textarea {
                font-size: 20px;
            }
            
            .control-button {
                min-width: calc(50% - 4px);
                padding: 8px 4px;
            }
        }
        
        .suffix-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 87, 34, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 50%;
            font-size: 12px;
            font-weight: bold;
            min-width: 20px;
            text-align: center;
        }
        
        #youtube-background {
            position: fixed;
            top: -9999px;
            left: -9999px;
            width: 1px;
            height: 1px;
            opacity: 0;
            z-index: -9999;
        }
        
        .music-status {
            position: fixed;
            bottom: 10px;
            right: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: #4CAF50;
            padding: 8px 15px;
            border-radius: 15px;
            z-index: 9999;
            font-size: 14px;
            display: none;
            border: 1px solid #4CAF50;
            backdrop-filter: blur(5px);
            animation: fadeInOut 2s ease;
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translateY(10px); }
            20% { opacity: 1; transform: translateY(0); }
            80% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-10px); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üé§ K√©t Ablakos Hangfelismer√©s</h1>
        
        <div class="status-display" id="status">üü¢ K√©szen √°ll - V√°rja a 8-as gombot a felismer√©s ind√≠t√°s√°hoz</div>
        
        <div class="windows-container">
            <div class="window left-window">
                <div class="window-title">Bal ablak - Aktu√°lis felismer√©s (szerkeszthet≈ë)</div>
                <textarea id="leftWindowTextarea" class="editable-textarea"></textarea>
            </div>
            
            <div class="window right-window">
                <div class="window-title">Jobb ablak - T√°rol√≥ (kattints/√©rintsd a m√°sol√°shoz)</div>
                <div class="window-content" id="rightWindow">
                    <div class="empty-window">Itt gy≈±lnek a bal ablakb√≥l √°tvitt sz√∂vegek</div>
                </div>
            </div>
        </div>
        
        <div class="buttons-row top-row">
            <button class="control-button button-1" onclick="handleButton1()">
                <div>1Ô∏è‚É£</div>
                <div class="button-label">Bal ‚Üí Jobb √°thelyez√©s</div>
                <div class="key-indicator">Billenty≈±: 1</div>
            </button>
            
            <button class="control-button button-2" onclick="handleButton2()">
                <div>2Ô∏è‚É£</div>
                <div class="button-label">Pont/K√©rd≈ëjel hozz√°ad√°sa</div>
                <div class="key-indicator">Billenty≈±: 2</div>
            </button>
            
            <button class="control-button button-3" onclick="handleButton3()">
                <div>3Ô∏è‚É£</div>
                <div class="button-label">Minden vissza√°ll√≠t√°s</div>
                <div class="key-indicator">Billenty≈±: 3</div>
            </button>
            
            <button class="control-button button-4" onclick="handleButton4()">
                <div>4Ô∏è‚É£</div>
                <div class="button-label">Felolvas√°s/Let√∂lt√©s</div>
                <div class="key-indicator">Billenty≈±: 4</div>
            </button>
        </div>
        
        <div class="buttons-row bottom-row">
            <button class="control-button button-5" onclick="handleButton5()">
                <div>5Ô∏è‚É£</div>
                <div class="button-label">Elv√°laszt√≥ hozz√°ad√°sa</div>
                <div class="key-indicator">Billenty≈±: 5</div>
            </button>
            
            <button class="control-button button-6" onclick="handleButton6()">
                <div>6Ô∏è‚É£</div>
                <div class="button-label">Suffix kiv√°laszt√°s/felolvas√°s</div>
                <div class="key-indicator">Billenty≈±: 6</div>
                <div id="suffixCounter" class="suffix-counter">1/12</div>
            </button>
            
            <button class="control-button button-7" onclick="handleButton7()">
                <div>7Ô∏è‚É£</div>
                <div class="button-label">Jobb ablak ment√©se (els≈ë k√©t mondat n√©vvel)</div>
                <div class="key-indicator">Billenty≈±: 7</div>
            </button>
            
            <button class="control-button button-8" onclick="handleButton8()">
                <div>8Ô∏è‚É£</div>
                <div class="button-label">Felismer√©s ind√≠t√°sa/megszak√≠t√°sa</div>
                <div class="key-indicator">Billenty≈±: 8</div>
            </button>
        </div>
        
        <div class="instructions">
            <h3>üìã Haszn√°lati √∫tmutat√≥:</h3>
            <ul>
                <li><span class="key">8</span> - Egyszer megnyomva: hangfelismer√©s le√°ll√≠t√°sa √©s a bal ablak tartalm√°nak felolvas√°sa</li>
                <li><span class="key">8</span> - Gyorsan k√©tszer megnyomva: bal ablak t√∂rl√©se √©s hangfelismer√©s √∫jraind√≠t√°sa</li>
                <li><span class="key">1</span> - Bal ablak tartalm√°nak √°thelyez√©se a jobb ablakba (folytat√°sk√©nt) √©s bal ablak t√∂rl√©se</li>
                <li><span class="key">2</span> - Egyszer megnyomva: pont hozz√°ad√°sa a bal ablak v√©g√©re</li>
                <li><span class="key">2</span> - Gyorsan k√©tszer megnyomva: k√©rd≈ëjel hozz√°ad√°sa a bal ablak v√©g√©re</li>
                <li><span class="key">3</span> - Minden vissza√°ll√≠t√°sa alap√°llapotba (mindk√©t ablak t√∂rl√©se, felismer√©s le√°ll√≠t√°sa)</li>
                <li><span class="key">4</span> - Egyszeri nyom√°s: jobb ablak tartalm√°nak felolvas√°sa (most m√°r felki√°lt√≥jelet, k√©rd≈ëjelet √©s pontot is felolvas)</li>
                <li><span class="key">4</span> - Gyorsan k√©tszer megnyomva: jobb ablak tartalm√°nak let√∂lt√©se txt f√°jlk√©nt</li>
                <li><span class="key">5</span> - Elv√°laszt√≥ sor hozz√°ad√°sa a jobb ablak v√©g√©re</li>
                <li><span class="key">6</span> - Suffix ciklikus kiv√°laszt√°sa, bal ablakba √≠r√°sa √©s felolvas√°sa (12 lehet≈ës√©g)</li>
                <li><span class="key">7</span> - Egyszeri nyom√°s: jobb ablak ment√©se txt f√°jlk√©nt (els≈ë k√©t mondat f√°jln√©vk√©nt)</li>
                <li><span class="key">7</span> - Gyorsan k√©tszer megnyomva: jobb ablak tartalm√°nak m√°sol√°sa v√°g√≥lapra</li>
                <li><span class="key">Kattint√°s a jobb ablakra</span> - Jobb ablak tartalm√°nak m√°sol√°sa v√°g√≥lapra</li>
                <li><span class="key">Bal ablak</span> - Most m√°r szerkeszthet≈ë textarea, k√∂zvetlen√ºl √≠rhatsz vagy m√≥dos√≠thatsz sz√∂veget</li>
            </ul>
            <p style="margin-top: 15px; font-size: 12px; opacity: 0.9;"><strong>Megjegyz√©s:</strong> A jobb ablak tartalma csak b≈ëv√ºl, soha nem t√∂rl≈ëdik. Kattint√°ssal vagy √©rint√©ssel m√°solhat√≥ v√°g√≥lapra.</p>
        </div>
    </div>

    <!-- Zene st√°tusz jelz≈ë -->
    <div id="music-status" class="music-status">üéµ H√°tt√©rzene akt√≠v</div>

    <div id="youtube-background">
    <iframe 
        id="youtube-player"
        width="0" 
        height="0" 
        src="https://www.youtube.com/embed/eA2onFhKfpU?autoplay=0&loop=1&playlist=eA2onFhKfpU&mute=1&controls=0&showinfo=0&rel=0&modestbranding=1&hl=hu-HU&enablejsapi=1" 
        frameborder="0" 
        allow="autoplay; encrypted-media" 
        allowfullscreen>
    </iframe>
</div>

    <script>
        // YouTube h√°tt√©rzene v√°ltoz√≥k
        let youtubePlayer = null;
        let musicStarted = false;
        let playerReady = false;

        // YouTube API inicializ√°l√°sa - JAV√çTOTT
        function onYouTubeIframeAPIReady() {
            youtubePlayer = new YT.Player('youtube-player', {
                playerVars: {
                    'autoplay': 0,
                    'loop': 1,
                    'playlist': 'NK3OU-Ka_hA',
                    'mute': 1,
                    'controls': 0,
                    'showinfo': 0,
                    'rel': 0,
                    'modestbranding': 1,
                    'hl': 'hu-HU'
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError
                }
            });
        }

        function onPlayerReady(event) {
            playerReady = true;
            // Alap√©rtelmezett hanger≈ë be√°ll√≠t√°sa
            event.target.setVolume(1);
            console.log("‚úÖ YouTube player k√©sz √©s k√©szen √°ll");
        }

        function onPlayerStateChange(event) {
            // Ha a vide√≥ v√©get √©rt, √∫jraind√≠tjuk
            if (event.data === YT.PlayerState.ENDED) {
                event.target.playVideo();
            }
            
            // Debug inform√°ci√≥
            console.log("YouTube √°llapot v√°ltoz√°s:", event.data);
        }

        function onPlayerError(event) {
            console.error("YouTube player hiba:", event.data);
        }

        // Zene ind√≠t√°sa - CSAK EGYSZER - JAV√çTOTT
        function startBackgroundMusicOnce() {
            console.log("startBackgroundMusicOnce h√≠vva");
            console.log("musicStarted:", musicStarted);
            console.log("playerReady:", playerReady);
            console.log("youtubePlayer:", youtubePlayer);
            
            if (musicStarted) {
                console.log("‚ö†Ô∏è Zene m√°r elindult, nem indul √∫jra");
                return false;
            }
            
            if (!playerReady || !youtubePlayer) {
                console.log("‚ùå YouTube player nincs k√©sz vagy nincs inicializ√°lva");
                return false;
            }
            
            try {
                // JAV√çTOTT: YouTube API megfelel≈ë met√≥dusok
                // 1. El≈ësz√∂r n√©m√≠t√°s felold√°sa
                youtubePlayer.unMute();  // Ez a helyes met√≥dusn√©v
                
                // 2. Lej√°tsz√°s ind√≠t√°sa
                youtubePlayer.playVideo();
                
                musicStarted = true;
                
                // St√°tusz jelz≈ë
                const statusEl = document.getElementById('music-status');
                if (statusEl) {
                    statusEl.style.display = 'block';
                    setTimeout(() => {
                        statusEl.style.display = 'none';
                    }, 2000);
                }
                
                console.log("‚úÖ H√°tt√©rzene elind√≠tva (csak egyszer)");
                return true;
            } catch (error) {
                console.log("‚ùå Zene ind√≠t√°si hiba:", error);
                
                // Alternat√≠v m√≥dszer, ha az els≈ë nem m≈±k√∂dik
                try {
                    // A player objektumon kereszt√ºl is megpr√≥b√°lhatjuk
                    if (youtubePlayer.player) {
                        youtubePlayer.player.unMute();
                        youtubePlayer.player.playVideo();
                        musicStarted = true;
                        console.log("‚úÖ H√°tt√©rzene elind√≠tva (alternat√≠v m√≥dszer)");
                        return true;
                    }
                } catch (altError) {
                    console.log("‚ùå Alternat√≠v zene ind√≠t√°si hiba:", altError);
                }
                
                return false;
            }
        }

        // F≈ë v√°ltoz√≥k
        const status = document.getElementById('status');
        const leftWindowTextarea = document.getElementById('leftWindowTextarea');
        const rightWindow = document.getElementById('rightWindow');
        const suffixCounter = document.getElementById('suffixCounter');
        
        let recognition = null;
        let isRecording = false;
        let lastButton2Press = 0;
        let lastButton3Press = 0;
        let lastButton4Press = 0;
        let lastButton6Press = 0;
        let lastButton7Press = 0;
        let leftWindowText = '';
        let rightWindowText = '';
        
        // 8-as gomb v√°ltoz√≥k
        let key8PressStartTime = 0;
        let key8LongPressTimer = null;
        let key8WasLongPress = false;
        const LONG_PRESS_DURATION = 1000;
        
        let lastButton8Press = 0;
        const DOUBLE_PRESS_TIME = 300;
        
        // Suffix lista (12 elem)
        let suffixSelectionState = 0;
        let selectedSuffix = "";
        const suffixes = [
            
               "A t√∂bbi k√≥don ne v√°ltoztass. K√©rem az eg√©sz html k√≥dokat v√©gig. a m√≥dos√≠t√°sok v√©grehajt√°sa sor√°n t√∂rekedj a kis √©s hat√©kony k√≥dok alkalmaz√°s√°ra.",
            
            "rep√ºl≈ën j√°tsz√≥dik a t√∂rt√©net.  k√©rek konkr√©t friss helysz√≠nhez k√∂thet≈ë h√°tt√©rzajokat ambiance vide√≥kat, URL c√≠meket. lehet √°ltal√°nosabb de az√©rt a helysz√≠nhez hasonl√≥.√âs legv√©g√ºl 5 db , a sz√∂veg helysz√≠n√©hez k√∂thet≈ë vagy passzol√≥ h√°tt√©rzajokat ambiance vide√≥kat keres≈ëprompt sz√∂veget, angolul. Ezek legyenek google keres≈ëlinkek (kattintva ugr√≥sak).",
            
            "K√©rem az eg√©sz html k√≥dokat v√©gig.",
            "Csak a szkript k√≥dokat k√©rem, a script tagt√≥l v√©gig, a body √©s html Closing tagokkal.",
           
            "a m√≥dos√≠tott szkript k√≥dokat k√©rem a script tagt√≥l a ==========felecomment==========comment sorig.",
            "a szkript k√≥dokat k√©rem a ==========felecomment==========comment sort√≥l v√©gig a body √©s html Closing tagokkal.",
            
            "van-e m√≥dos√≠t√°s a fele comment ut√°ni r√©szben az eddigi k√©r√©sem alapj√°n? vagy ez marad ugyan√∫gy?",
            
            
            
            "K√©rek youtube konkr√©t friss linkeket. √çrd ki a linkeket. T√©ma a ",
            "Aj√°nlj konkr√©t friss youtube c√≠meket, ehhez passzol√≥ ambience zene n√©lk√ºli vide√≥kat. √çrd ki a linkeket.",
            
            "te kreat√≠v vagy? √≠rd √°t a t√∂rt√©netet. a legfontosabb hogy j√≥val r√©szletesebben legyenek az akci√≥k, jelenetek √°br√°zolva, legyen benne m√©g t√∂bb helyzetkomikum √©s boh√≥zat n√©mi ir√≥ni√°val f≈±szerezve. a fekete humor se hi√°nyozzon bel≈ële. legyenek √°tvezet≈ë jelenetek mozifilm szer≈± kamera n√©zetek √©s n√©z≈ëpont v√°lt√°sok a helysz√≠nek √©s a t√∂rt√©net l√©nyege maradhat hasonl√≥ vagy ugyanaz.",
            
            "Te kreat√≠v vagy? folytasd, √≠rd meg a k√∂vetkez≈ë fejezetet. Kapcsol√≥djon az els≈ë fejezethez. (a st√≠lushoz √©s hangulathoz h≈±en)",
            
             "van e benne komolyabb hiba (a hi√°nyz√≥ funkci√≥kat nem sz√°m√≠tva)?",
                "A megl√©v≈ë scriptet m√≥dos√≠tsd. ",
                "Min√©l kevesebb k√≥ddal min√©l kevesebb karakterrel min√©l egyszer≈±bben k√©rem az √∫j√≠t√°sokat.",
                
            "Gener√°lj k√©pet. Jellegzetes, √©l√©nk sz√≠nekkel, kontrasztos f√©ny-√°rny√©k hat√°sokkal, kiss√© rajzfilmszer≈±, de m√©gis r√©szleteiben kidolgozott, dinamikus √©s akci√≥d√∫s vizu√°lis megjelen√©st haszn√°lva.",
            
            "k√©rek javascriptet. legyen hozz√° egy scriptb≈ël l√©trehozott √≠zl√©ses de kev√©s k√≥db√≥l √°ll√≥ opci√≥s men√º. ez az options men√º legyen megnyithat√≥ a k√∂vetkez≈ë gombok egy√ºttes lenyom√°s√°val: kilences gomb √©s az i gomb lenyom√°sa. minden legyen kiz√°r√≥lag javascriptb≈ël l√©trehozva. a tov√°bbi r√©szleteket k√©s≈ëbb fogjuk megalkotni √©s most k√©rem a k√≥dot.legyen glob√°lisan k√∂nnyen megh√≠vhat√≥ funkci√≥. k√©rek p√©lda megh√≠v√°st commentet.",
            
            
            "F√≥kusz√°lj a megadott strukt√∫r√°ra.",
            "aaa",
        ];
        
        // Jobb ablak esem√©nyfigyel≈ëk
        rightWindow.addEventListener('click', function() {
            if (rightWindowText.trim()) {
                copyRightWindowToClipboard();
            } else {
                playWarningBeep();
                showNotification("üìù Nincs sz√∂veg a jobb ablakban!");
            }
        });
        
        rightWindow.addEventListener('touchend', function(event) {
            if (rightWindowText.trim()) {
                event.preventDefault();
                copyRightWindowToClipboard();
            } else {
                playWarningBeep();
                showNotification("üìù Nincs sz√∂veg a jobb ablakban!");
            }
        });
        
        // Bal ablak textarea esem√©nyfigyel≈ë - szinkroniz√°lja a v√°ltoz√°st
        leftWindowTextarea.addEventListener('input', function() {
            leftWindowText = leftWindowTextarea.value;
        });
        
        // Alapvet≈ë f√ºggv√©nyek
        function copyRightWindowToClipboard() {
            if (!rightWindowText.trim()) return;
            
            navigator.clipboard.writeText(rightWindowText).then(() => {
                showNotification("üìã Jobb ablak tartalma v√°g√≥lapra m√°solva!");
            }).catch(err => {
                console.error('V√°g√≥lapra m√°sol√°s hiba:', err);
                showNotification("‚ùå Hiba a v√°g√≥lapra m√°sol√°skor");
            });
        }
        
        function stopAllSpeech() {
            if (speechSynthesis.speaking) {
                speechSynthesis.cancel();
            }
        }
        
        function updateSuffixCounter() {
            suffixCounter.textContent = `${suffixSelectionState + 1}/${suffixes.length}`;
        }
        
        function showNotification(message) {
            const existingNotifications = document.querySelectorAll('.clipboard-notification');
            existingNotifications.forEach(notification => notification.remove());
            
            const notification = document.createElement('div');
            notification.className = 'clipboard-notification';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                if (notification.parentNode) notification.remove();
            }, 2000);
        }
        
        function updateRightWindow() {
            if (rightWindowText.trim()) {
                rightWindow.innerHTML = `<div>${rightWindowText}</div>`;
                rightWindow.classList.remove('empty-window');
            } else {
                rightWindow.innerHTML = '<div class="empty-window">Itt gy≈±lnek a bal ablakb√≥l √°tvitt sz√∂vegek</div>';
            }
        }
        
        function updateLeftWindow() {
            leftWindowTextarea.value = leftWindowText || "";
        }
        
        function getRandomWordsFromText(text, count) {
            if (!text.trim()) return "szoveg";
            
            const words = text.split(/\s+/).filter(word => word.length > 2);
            const selectedWords = [];
            
            if (words.length === 0) return "szoveg";
            
            for (let i = 0; i < count; i++) {
                if (words.length > 0) {
                    const randomIndex = Math.floor(Math.random() * words.length);
                    let cleanWord = words[randomIndex].replace(/[.,?!;:()"']/g, '');
                    if (cleanWord.length > 0) selectedWords.push(cleanWord);
                }
            }
            
            while (selectedWords.length < count) {
                selectedWords.push("szoveg" + (selectedWords.length + 1));
            }
            
            return selectedWords.slice(0, count).join('_');
        }
        
        // Gombkezel≈ëk
        function handleButton1() {
            // Friss√≠tj√ºk a v√°ltoz√≥t a textarea aktu√°lis tartalm√°val
            leftWindowText = leftWindowTextarea.value.trim();
            
            if (!leftWindowText) {
                status.textContent = "üìù Nincs sz√∂veg a bal ablakban!";
                status.className = "status-display";
                playWarningBeep();
                return;
            }
            
            if (rightWindowText.trim()) {
                rightWindowText += ' ' + leftWindowText;
            } else {
                rightWindowText = leftWindowText;
            }
            
            updateRightWindow();
            leftWindowText = '';
            updateLeftWindow();
            
            copyRightWindowToClipboard();
            
            status.textContent = "‚úÖ Bal ablak tartalma √°tker√ºlt a jobb ablakba (v√°g√≥lapra m√°solva)";
            status.className = "status-display success";
            playSuccessBeep();
        }
        
        function handleButton2() {
            const currentTime = Date.now();
            const isDoublePress = (currentTime - lastButton2Press) < DOUBLE_PRESS_TIME;
            
            // Friss√≠tj√ºk a v√°ltoz√≥t a textarea aktu√°lis tartalm√°val
            leftWindowText = leftWindowTextarea.value.trim();
            
            if (!leftWindowText) {
                status.textContent = "üìù Nincs sz√∂veg a bal ablakban!";
                status.className = "status-display";
                playWarningBeep();
                lastButton2Press = currentTime;
                return;
            }
            
            leftWindowText = leftWindowText.trim();
            if (leftWindowText.endsWith('.')) leftWindowText = leftWindowText.slice(0, -1);
            if (leftWindowText.endsWith('?')) leftWindowText = leftWindowText.slice(0, -1);
            if (leftWindowText.endsWith('!')) leftWindowText = leftWindowText.slice(0, -1);
            
            if (isDoublePress) {
                leftWindowText += '?';
                status.textContent = "‚ùì K√©rd≈ëjel hozz√°adva";
                playDeleteBeep();
            } else {
                leftWindowText += '.';
                status.textContent = "üîµ Pont hozz√°adva";
                playSuccessBeep();
            }
            
            updateLeftWindow();
            lastButton2Press = currentTime;
        }
        
        function handleButton3() {
            const currentTime = Date.now();
            const isDoublePress = (currentTime - lastButton3Press) < DOUBLE_PRESS_TIME;
            
            stopVoiceRecognition();
            stopAllSpeech();
            
            leftWindowText = '';
            rightWindowText = '';
            updateLeftWindow();
            updateRightWindow();
            
            suffixSelectionState = 0;
            updateSuffixCounter();
            
            status.textContent = "üîÑ Minden vissza√°ll√≠tva alap√°llapotba";
            status.className = "status-display success";
            
            playDeleteBeep();
            lastButton3Press = currentTime;
        }
        
        function handleButton4() {
            const currentTime = Date.now();
            const isDoublePress = (currentTime - lastButton4Press) < DOUBLE_PRESS_TIME;
            
            if (!rightWindowText.trim()) {
                status.textContent = "üìù Nincs sz√∂veg a jobb ablakban!";
                status.className = "status-display";
                playWarningBeep();
                lastButton4Press = currentTime;
                return;
            }
            
            if (isDoublePress) {
                const filename = getRandomWordsFromText(rightWindowText, 3) + '.txt';
                downloadTextAsFile(rightWindowText, filename);
                status.textContent = "üíæ Jobb ablak tartalma let√∂ltve: " + filename;
                playSuccessBeep();
            } else {
                // M√ìDOS√çTOTT: Most m√°r felki√°lt√≥jelet, k√©rd≈ëjelet √©s pontot is felolvas
                const textWithPunctuation = rightWindowText
                    .replace(/\./g, ' . ')
                    .replace(/\?/g, ' ? ')
                    .replace(/!/g, ' ! ')
                    .replace(/\s+/g, ' ')
                    .trim();
                readTextAloud(textWithPunctuation, 0.8);
                status.textContent = "üîä Jobb ablak tartalma felolvasva (most m√°r pontot, k√©rd≈ëjelet √©s felki√°lt√≥jelet is)";
                playSuccessBeep();
            }
            
            lastButton4Press = currentTime;
        }
        
        function handleButton5() {
            if (rightWindowText.trim()) {
                rightWindowText += '\n\n';
            } else {
                rightWindowText = '\n\n';
            }
            
            updateRightWindow();
            copyRightWindowToClipboard();
            
            status.textContent = "üìé Elv√°laszt√≥ hozz√°adva a jobb ablak v√©g√©re (v√°g√≥lapra m√°solva)";
            status.className = "status-display success";
            playSuccessBeep();
        }
        
        function handleButton6() {
            const currentTime = Date.now();
            const isDoublePress = (currentTime - lastButton6Press) < DOUBLE_PRESS_TIME;
            
            if (isDoublePress) {
                playSpecialBeep();
                return;
            }
            
            stopAllSpeech();
            
            if (suffixSelectionState >= suffixes.length) suffixSelectionState = 0;
            selectedSuffix = suffixes[suffixSelectionState];
            
            leftWindowText = selectedSuffix;
            
            readTextAloud(selectedSuffix, 0.8);
            updateLeftWindow();
            updateSuffixCounter();
            
            status.textContent = `‚úÖ Besz√©d le√°ll√≠tva, suffix ${suffixSelectionState + 1}/${suffixes.length} bal ablakba √≠rva √©s felolvasva`;
            status.className = "status-display success";
            playSuccessBeep();
            
            suffixSelectionState++;
            if (suffixSelectionState >= suffixes.length) suffixSelectionState = 0;
            
            lastButton6Press = currentTime;
        }
        
        function handleButton7() {
            const currentTime = Date.now();
            const isDoublePress = (currentTime - lastButton7Press) < DOUBLE_PRESS_TIME;
            
            if (!rightWindowText.trim()) {
                status.textContent = "üìù Nincs sz√∂veg a jobb ablakban!";
                status.className = "status-display";
                playWarningBeep();
                lastButton7Press = currentTime;
                return;
            }
            
            const firstTwoSentences = extractFirstTwoSentences(rightWindowText);
            let filename = "hangfelismeres.txt";
            
            if (firstTwoSentences && firstTwoSentences.trim().length > 0) {
                filename = cleanTextForFilename(firstTwoSentences);
                if (filename.length > 50) filename = filename.substring(0, 50);
                if (!filename.toLowerCase().endsWith('.txt')) filename += '.txt';
            }
            
            if (isDoublePress) {
                navigator.clipboard.writeText(rightWindowText).then(() => {
                    showNotification("üìã Jobb ablak tartalma a v√°g√≥lapra m√°solva!");
                });
                status.textContent = "üìã Jobb ablak tartalma v√°g√≥lapra m√°solva";
                playSuccessBeep();
            } else {
                downloadTextAsFile(rightWindowText, filename);
                status.textContent = `üíæ Mentve: ${filename}`;
                playSuccessBeep();
            }
            
            lastButton7Press = currentTime;
        }
        
        // 8-as gomb: JAV√çTOTT - zene csak egyszer indul
        function handleButton8Single() {
            const currentTime = Date.now();
            const isDoublePress = (currentTime - lastButton8Press) < DOUBLE_PRESS_TIME;
            
            lastButton8Press = currentTime;
            
            if (isDoublePress) {
                stopVoiceRecognition();
                stopAllSpeech();
                
                leftWindowText = '';
                updateLeftWindow();
                
                setTimeout(() => {
                    startVoiceRecognition();
                }, 100);
                
                status.textContent = "üîÑ Bal ablak t√∂r√∂lve, hangfelismer√©s √∫jraind√≠tva (dupla nyom√°s)";
                status.className = "status-display";
                playDeleteBeep();
                return;
            }
            
            if (isRecording) {
                stopVoiceRecognition();
                
                // Friss√≠tj√ºk a v√°ltoz√≥t a textarea aktu√°lis tartalm√°val
                leftWindowText = leftWindowTextarea.value.trim();
                
                if (leftWindowText) {
                    // M√ìDOS√çTOTT: Most m√°r felki√°lt√≥jelet, k√©rd≈ëjelet √©s pontot is felolvas
                    const textWithPunctuation = leftWindowText
                        .replace(/\./g, ' . ')
                        .replace(/\?/g, ' ? ')
                        .replace(/!/g, ' ! ')
                        .replace(/\s+/g, ' ')
                        .trim();
                    readTextAloud(textWithPunctuation, 0.8);
                    status.textContent = "üîä Hangfelismer√©s le√°ll√≠tva, felolvasva (most m√°r pontot, k√©rd≈ëjelet √©s felki√°lt√≥jelet is)";
                    status.className = "status-display success";
                } else {
                    status.textContent = "‚è∏Ô∏è Hangfelismer√©s le√°ll√≠tva";
                    status.className = "status-display";
                }
                
                playSuccessBeep();
            } else {
                startVoiceRecognition();
                // Zene ind√≠t√°sa csak els≈ë alkalommal
                if (!musicStarted) {
                    console.log("Zene ind√≠t√°sa...");
                    const musicSuccess = startBackgroundMusicOnce();
                    if (musicSuccess) {
                        status.textContent = "üé§ Hangfelismer√©s ind√≠tva + üéµ H√°tt√©rzene elind√≠tva";
                    } else {
                        status.textContent = "üé§ Hangfelismer√©s ind√≠tva (zene ind√≠t√°s sikertelen)";
                    }
                } else {
                    status.textContent = "üé§ Hangfelismer√©s ind√≠tva";
                }
                playStartBeep();
            }
        }
        
        function handleButton8LongPress() {
            key8WasLongPress = true;
            
            leftWindowText = '';
            updateLeftWindow();
            
            if (isRecording) stopVoiceRecognition();
            
            setTimeout(() => {
                startVoiceRecognition();
            }, 100);
            
            status.textContent = "üîÑ Bal ablak t√∂r√∂lve, hangfelismer√©s ind√≠tva (hossz√∫ nyom√°s)";
            status.className = "status-display";
            playDeleteBeep();
            
            lastButton8Press = Date.now();
        }
        
        function handleButton8() {
            handleButton8Single();
        }
        
        function handleButton8KeyDown() {
            if (!key8PressStartTime) {
                key8PressStartTime = Date.now();
                key8WasLongPress = false;
                
                key8LongPressTimer = setTimeout(() => {
                    handleButton8LongPress();
                }, LONG_PRESS_DURATION);
            }
        }
        
        function handleButton8KeyUp() {
            const currentTime = Date.now();
            
            if (key8LongPressTimer) {
                clearTimeout(key8LongPressTimer);
                key8LongPressTimer = null;
            }
            
            if (key8PressStartTime && !key8WasLongPress) {
                const pressDuration = currentTime - key8PressStartTime;
                
                if (pressDuration < LONG_PRESS_DURATION) {
                    handleButton8Single();
                }
            }
            
            key8PressStartTime = 0;
        }
        
        // Seg√©df√ºggv√©nyek
        function extractFirstTwoSentences(text) {
            if (!text.trim()) return "";
            
            const sentenceRegex = /[^.!?]+[.!?]+/g;
            const sentences = text.match(sentenceRegex);
            
            if (!sentences || sentences.length === 0) {
                const words = text.trim().split(/\s+/).slice(0, 3);
                return words.join(' ');
            }
            
            const firstTwo = sentences.slice(0, 2);
            return firstTwo.join(' ').trim();
        }
        
        function cleanTextForFilename(text) {
            if (!text.trim()) return "hangfelismeres";
            
            const diacriticsMap = {
                '√°': 'a', '√©': 'e', '√≠': 'i', '√≥': 'o', '√∂': 'o', '≈ë': 'o', '√∫': 'u', '√º': 'u', '≈±': 'u',
                '√Å': 'A', '√â': 'E', '√ç': 'I', '√ì': 'O', '√ñ': 'O', '≈ê': 'O', '√ö': 'U', '√ú': 'U', '≈∞': 'U'
            };
            
            let cleaned = text.trim();
            cleaned = cleaned.replace(/[√°√©√≠√≥√∂≈ë√∫√º≈±√Å√â√ç√ì√ñ≈ê√ö√ú≈∞]/g, match => diacriticsMap[match] || match);
            cleaned = cleaned.replace(/[^a-zA-Z0-9\s\-_.,!?]/g, ' ');
            cleaned = cleaned.replace(/\s+/g, ' ');
            
            if (!cleaned.trim()) return "hangfelismeres";
            
            const words = cleaned.trim().split(/\s+/);
            if (words.length > 6) cleaned = words.slice(0, 6).join(' ');
            
            return cleaned.trim();
        }
        
        function downloadTextAsFile(text, filename) {
            const blob = new Blob([text], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            setTimeout(() => {
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }, 100);
        }
        
        function startVoiceRecognition() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                status.textContent = "‚ùå B√∂ng√©sz≈ë nem t√°mogatja a hangfelismer√©st";
                return false;
            }
            
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            
            recognition.lang = 'hu-HU';
            recognition.interimResults = false;
            recognition.continuous = true;
            
            recognition.onstart = function() {
                isRecording = true;
                status.textContent = "üé§ Hangfelismer√©s folyamatban...";
                status.className = "status-display recording";
                playStartBeep();
            };
            
            recognition.onresult = function(event) {
                for (let i = event.resultIndex; i < event.results.length; i++) {
                    if (event.results[i].isFinal) {
                        const transcript = event.results[i][0].transcript.trim();
                        if (transcript) {
                            if (leftWindowText) {
                                leftWindowText += ' ' + transcript;
                            } else {
                                leftWindowText = transcript;
                            }
                            updateLeftWindow();
                        }
                    }
                }
            };
            
            recognition.onerror = function(event) {
                console.error('Hangfelismer√©si hiba:', event.error);
                if (event.error === 'not-allowed') status.textContent = "‚ùå Enged√©lyezze a mikrofont!";
                stopVoiceRecognition();
            };
            
            recognition.onend = function() {
                if (isRecording && recognition) {
                    setTimeout(() => {
                        try { recognition.start(); } catch (e) { console.error('√öjraind√≠t√°si hiba:', e); }
                    }, 100);
                }
            };
            
            try {
                recognition.start();
                return true;
            } catch (e) {
                console.error('Ind√≠t√°si hiba:', e);
                status.textContent = "‚ùå Ind√≠t√°si hiba";
                return false;
            }
        }
        
        function stopVoiceRecognition() {
            if (recognition) recognition.stop();
            isRecording = false;
            status.classList.remove('recording');
        }
        
        function readTextAloud(text, volume) {
            if (!text.trim()) return;
            
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'hu-HU';
            utterance.volume = volume;
            
            utterance.onstart = () => status.textContent = "üîä Visszaolvas√°s...";
            utterance.onend = () => setTimeout(() => { status.textContent = "üü¢ K√©szen √°ll"; }, 500);
            
            speechSynthesis.speak(utterance);
        }
        
        // Hangjelz√©sek
        function playBeep(frequency, duration, volume, type) {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.type = type;
                oscillator.frequency.value = frequency;
                gainNode.gain.value = volume;
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                const currentTime = audioContext.currentTime;
                gainNode.gain.setValueAtTime(0.001, currentTime);
                gainNode.gain.exponentialRampToValueAtTime(volume, currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, currentTime + duration / 1000);
                
                oscillator.start(currentTime);
                oscillator.stop(currentTime + duration / 1000);
            } catch (e) { console.error('Hangjelz√©s hiba:', e); }
        }
        
        function playSpecialBeep() {
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator1 = audioContext.createOscillator();
                const oscillator2 = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator1.type = 'sine'; oscillator1.frequency.value = 600;
                oscillator2.type = 'sine'; oscillator2.frequency.value = 800;
                gainNode.gain.value = 0.1;
                
                oscillator1.connect(gainNode);
                oscillator2.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                const currentTime = audioContext.currentTime;
                gainNode.gain.setValueAtTime(0.001, currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.1, currentTime + 0.01);
                gainNode.gain.exponentialRampToValueAtTime(0.001, currentTime + 0.3);
                
                oscillator1.start(currentTime);
                oscillator2.start(currentTime);
                oscillator1.stop(currentTime + 0.3);
                oscillator2.stop(currentTime + 0.3);
            } catch (e) { console.error('Speci√°lis hangjelz√©s hiba:', e); }
        }
        
        function playStartBeep() { playBeep(800, 100, 0.1, 'sine'); }
        function playSuccessBeep() { playBeep(600, 150, 0.1, 'sine'); }
        function playDeleteBeep() { playBeep(400, 200, 0.1, 'sawtooth'); }
        function playWarningBeep() { playBeep(300, 150, 0.1, 'square'); }
        
        // Billenty≈±zet kezel√©s
        document.addEventListener('keydown', function(e) {
            const activeElement = document.activeElement;
            const isInput = activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA';
            
            // Ha a bal oldali textarea-ban vagyunk, csak az Escape billenty≈± m≈±k√∂dj√∂n
            if (activeElement.id === 'leftWindowTextarea' && e.key !== 'Escape') {
                return;
            }
            
            // Ha m√°s input mez≈ëben vagyunk, nem dolgozzuk fel a billenty≈±ket
            if (isInput && activeElement.id !== 'leftWindowTextarea') return;
            
            switch(e.key) {
                case '1': e.preventDefault(); handleButton1(); break;
                case '2': e.preventDefault(); handleButton2(); break;
                case '3': e.preventDefault(); handleButton3(); break;
                case '4': e.preventDefault(); handleButton4(); break;
                case '5': e.preventDefault(); handleButton5(); break;
                case '6': e.preventDefault(); handleButton6(); break;
                case '7': e.preventDefault(); handleButton7(); break;
                case '8': e.preventDefault(); handleButton8KeyDown(); break;
                case 'Escape': e.preventDefault(); stopVoiceRecognition(); stopAllSpeech(); status.textContent = "üõë V√©szle√°ll√≠t√°s"; playWarningBeep(); break;
            }
        });
        
        document.addEventListener('keyup', function(e) {
            const activeElement = document.activeElement;
            const isInput = activeElement.tagName === 'INPUT' || activeElement.tagName === 'TEXTAREA';
            
            // Ha a bal oldali textarea-ban vagyunk, csak az Escape billenty≈± m≈±k√∂dj√∂n
            if (activeElement.id === 'leftWindowTextarea' && e.key !== 'Escape') {
                return;
            }
            
            // Ha m√°s input mez≈ëben vagyunk, nem dolgozzuk fel a billenty≈±ket
            if (isInput && activeElement.id !== 'leftWindowTextarea') return;
            
            if (e.key === '8') {
                e.preventDefault();
                handleButton8KeyUp();
            }
        });
        
        // Inicializ√°l√°s
        document.addEventListener('DOMContentLoaded', function() {
            // YouTube API bet√∂lt√©se
            const tag = document.createElement('script');
            tag.src = "https://www.youtube.com/iframe_api";
            const firstScriptTag = document.getElementsByTagName('script')[0];
            firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
            
            // 8-as gomb esem√©nykezel≈ëk
            const button8 = document.querySelector('.button-8');
            
            button8.addEventListener('mousedown', function(e) {
                e.preventDefault();
                handleButton8KeyDown();
            });
            
            button8.addEventListener('mouseup', function(e) {
                e.preventDefault();
                handleButton8KeyUp();
            });
            
            button8.addEventListener('mouseleave', function() {
                if (key8LongPressTimer) {
                    clearTimeout(key8LongPressTimer);
                    key8LongPressTimer = null;
                }
                key8PressStartTime = 0;
                key8WasLongPress = false;
            });
            
            button8.addEventListener('touchstart', function(e) {
                e.preventDefault();
                handleButton8KeyDown();
            });
            
            button8.addEventListener('touchend', function(e) {
                e.preventDefault();
                handleButton8KeyUp();
            });
            
            button8.addEventListener('touchcancel', function() {
                if (key8LongPressTimer) {
                    clearTimeout(key8LongPressTimer);
                    key8LongPressTimer = null;
                }
                key8PressStartTime = 0;
                key8WasLongPress = false;
            });
            
            button8.addEventListener('click', function(e) {
                handleButton8Single();
            });
            
            console.log('‚úÖ Alkalmaz√°s bet√∂ltve');
            console.log('‚úÖ YouTube h√°tt√©rzene inicializ√°lva');
            console.log('‚úÖ 8-as gomb ind√≠tja a zen√©t (csak egyszer)');
            console.log('‚úÖ Bal ablak most m√°r szerkeszthet≈ë textarea');
            
            updateSuffixCounter();
        });
        
        
// CLOSE - Aktu√°lis f√ºlet/b√∂ng√©sz≈ëablakot bez√°rja '0' gombbal
document.addEventListener('keydown', function(event) {
    // Ha a '0' billenty≈±t nyomj√°k meg
    if (event.key === '0' || event.key === 'Num0' || event.keyCode === 48 || event.keyCode === 96) {
        // Opcion√°lis: Ctrl+0 kombin√°ci√≥ra korl√°toz√°s, hogy ne t√∂rt√©njen v√©letlen bez√°r√°s
        // if (event.ctrlKey) {
            window.close();
            event.preventDefault(); // Megakad√°lyozzuk az alap√©rtelmezett viselked√©st
        // }
    }
});

    </script>
</body>
</html>